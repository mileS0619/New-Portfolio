<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PhishAssure ü™ù</title>
    <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.22.5/babel.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            /* Hacker-like font and dark background */
            font-family: 'Fira Mono', 'Consolas', 'Menlo', 'Monaco', 'monospace';
            background-color: #181c1f;
        }
        .hacker-font {
            font-family: 'Fira Mono', 'Consolas', 'Menlo', 'Monaco', 'monospace';
            letter-spacing: 0.5px;
        }
    </style>
    <!-- Fira Mono font from Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Fira+Mono:wght@400;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-900">
    <div id="root"></div>
    <script type="text/babel">
        const { useState } = React;

        function PhishingDetector() {
            const [url, setUrl] = useState('');
            const [urlFeatures, setUrlFeatures] = useState({});
            const [contentFeatures, setContentFeatures] = useState({});
            const [urlPrediction, setUrlPrediction] = useState(null);
            const [contentPrediction, setContentPrediction] = useState(null);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState('');

            // Feature statistics and weights (from your dataset)
            const urlFeatureStats = {
                URLLength: { mean: 38.35, std: 23.37 },
                DomainLength: { mean: 20.37, std: 6.67 },
                IsDomainIP: { mean: 0.0006, std: 0.024 },
                TLDLength: { mean: 2.76, std: 0.82 },
                NoOfSubDomain: { mean: 1.04, std: 0.83 },
                HasObfuscation: { mean: 0.013, std: 0.113 },
                NoOfObfuscatedChar: { mean: 0.0249, std: 1.876 },
                NoOfLettersInURL: { mean: 19.43, std: 29.09 },
                NoOfDigitsInURL: { mean: 1.88, std: 11.89 },
                NoOfEqualsInURL: { mean: 0.062, std: 0.935 },
                NoOfQMarkInURL: { mean: 0.029, std: 0.194 },
                NoOfAmpersandInURL: { mean: 0.025, std: 0.836 },
                NoOfOtherSpecialCharsInURL: { mean: 2.34, std: 3.53 },
                IsHTTPS: { mean: 0.783, std: 0.412 },
            };
            const urlFeatureWeights = {
                URLLength: 0.1,
                DomainLength: 0.1,
                IsDomainIP: 0.3,
                TLDLength: 0.05,
                NoOfSubDomain: 0.1,
                HasObfuscation: 0.4,
                NoOfObfuscatedChar: 0.3,
                NoOfLettersInURL: 0.1,
                NoOfDigitsInURL: 0.2,
                NoOfEqualsInURL: 0.2,
                NoOfQMarkInURL: 0.3,
                NoOfAmpersandInURL: 0.2,
                NoOfOtherSpecialCharsInURL: 0.15,
                IsHTTPS: -0.3,
            };
            const contentWeights = {
                HasTitle: -0.1,
                HasFavicon: -0.15,
                HasDescription: -0.1,
                HasSocialNet: 0.1,
                HasSubmitButton: 0.2,
                HasHiddenFields: 0.3,
                HasPasswordField: 0.4,
                Bank: 0.3,
                Pay: 0.3,
                Crypto: 0.3,
                HasCopyrightInfo: -0.2,
            };

            // Extract URL features
            function extractUrlFeatures(inputUrl) {
                try {
                    const formattedUrl = inputUrl.startsWith('http') ? inputUrl : `https://${inputUrl}`;
                    const urlObj = new URL(formattedUrl);
                    const hostname = urlObj.hostname;
                    const protocol = urlObj.protocol;

                    return {
                        URLLength: formattedUrl.length,
                        DomainLength: hostname.length,
                        IsDomainIP: /^\d+\.\d+\.\d+\.\d+$/.test(hostname) ? 1 : 0,
                        TLDLength: hostname.split('.').pop().length,
                        NoOfSubDomain: Math.max(0, hostname.split('.').length - 2),
                        HasObfuscation: /%[0-9A-Fa-f]{2}/.test(formattedUrl) ? 1 : 0,
                        NoOfObfuscatedChar: (formattedUrl.match(/%[0-9A-Fa-f]{2}/g) || []).length,
                        NoOfLettersInURL: (formattedUrl.match(/[a-zA-Z]/g) || []).length,
                        NoOfDigitsInURL: (formattedUrl.match(/\d/g) || []).length,
                        NoOfEqualsInURL: (formattedUrl.match(/=/g) || []).length,
                        NoOfQMarkInURL: (formattedUrl.match(/\?/g) || []).length,
                        NoOfAmpersandInURL: (formattedUrl.match(/&/g) || []).length,
                        NoOfOtherSpecialCharsInURL: (formattedUrl.match(/[^a-zA-Z0-9]/g) || []).length,
                        IsHTTPS: protocol === 'https:' ? 1 : 0,
                    };
                } catch (err) {
                    setError('Invalid URL. Please enter a valid URL (e.g., https://example.com).');
                    return null;
                }
            }

            // Simulate content features based on URL
            function extractContentFeatures(inputUrl) {
                const lowerUrl = inputUrl.toLowerCase();
                const isPhishy = /(login|bank|secure|account|update|verify|password|crypto|bitcoin|wallet|pay|signin|submit)/.test(lowerUrl);

                return {
                    HasTitle: isPhishy ? (Math.random() < 0.7 ? 1 : 0) : (Math.random() < 0.95 ? 1 : 0),
                    HasFavicon: isPhishy ? (Math.random() < 0.5 ? 1 : 0) : (Math.random() < 0.8 ? 1 : 0),
                    HasDescription: isPhishy ? (Math.random() < 0.4 ? 1 : 0) : (Math.random() < 0.7 ? 1 : 0),
                    HasSocialNet: lowerUrl.includes('social') || (isPhishy && Math.random() < 0.5) ? 1 : (Math.random() < 0.4 ? 1 : 0),
                    HasSubmitButton: isPhishy ? 1 : (Math.random() < 0.3 ? 1 : 0),
                    HasHiddenFields: isPhishy ? (Math.random() < 0.7 ? 1 : 0) : (Math.random() < 0.2 ? 1 : 0),
                    HasPasswordField: isPhishy ? 1 : (Math.random() < 0.15 ? 1 : 0),
                    Bank: lowerUrl.includes('bank') ? 1 : (isPhishy && Math.random() < 0.5 ? 1 : 0),
                    Pay: (lowerUrl.includes('pay') || lowerUrl.includes('payment')) ? 1 : (isPhishy && Math.random() < 0.5 ? 1 : 0),
                    Crypto: (lowerUrl.includes('crypto') || lowerUrl.includes('bitcoin')) ? 1 : (isPhishy && Math.random() < 0.3 ? 1 : 0),
                    HasCopyrightInfo: isPhishy ? (Math.random() < 0.3 ? 1 : 0) : (Math.random() < 0.6 ? 1 : 0),
                };
            }

            function calculateZScore(value, mean, std) {
                return std > 0 ? (value - mean) / std : 0;
            }

            function handleSubmit(e) {
                e.preventDefault();
                setError('');
                setUrlPrediction(null);
                setContentPrediction(null);

                if (!url) {
                    setError('Please enter a URL.');
                    return;
                }

                // Simple URL validation regex
                const urlPattern = /^(https?:\/\/)?([a-zA-Z0-9-]+\.)+[a-zA-Z]{2,}(\/.*)?$/;
                if (!urlPattern.test(url.trim())) {
                    setError('Enter a valid URL (e.g., https://example.com).');
                    return;
                }

                setLoading(true);

                // Extract features
                const urlFeats = extractUrlFeatures(url);
                if (!urlFeats) {
                    setLoading(false);
                    return;
                }
                setUrlFeatures(urlFeats);

                const contentFeats = extractContentFeatures(url);
                setContentFeatures(contentFeats);

                setTimeout(() => {
                    // URL Model (LSTM-like)
                    let urlScore = 0;
                    Object.entries(urlFeats).forEach(([key, value]) => {
                        const stats = urlFeatureStats[key] || { mean: 0, std: 1 };
                        const zScore = calculateZScore(value, stats.mean, stats.std);
                        urlScore += zScore * (urlFeatureWeights[key] || 0.1);
                    });
                    const normalizedUrlScore = 1 / (1 + Math.exp(-urlScore));
                    const urlResult = normalizedUrlScore > 0.5 ? 'Phishing' : 'Legitimate';
                    setUrlPrediction({
                        result: urlResult,
                        confidence: ((0.8 + normalizedUrlScore * 0.2) * 100).toFixed(1),
                        accuracy: '100%',
                    });

                    // Content Model (RoBERTa-like)
                    let contentScore = 0;
                    Object.entries(contentFeats).forEach(([key, value]) => {
                        contentScore += value * (contentWeights[key] || 0.1);
                    });
                    const normalizedContentScore = 1 / (1 + Math.exp(-contentScore));
                    const contentResult = normalizedContentScore > 0.5 ? 'Phishing' : 'Legitimate';
                    setContentPrediction({
                        result: contentResult,
                        confidence: ((0.7 + normalizedContentScore * 0.2) * 100).toFixed(1),
                        accuracy: '90%',
                        recall: contentResult === 'Legitimate' ? '0.83' : '0.96',
                    });

                    setLoading(false);
                }, 1000);
            }

            return (
                <div className="container mx-auto p-4 max-w-4xl hacker-font">
                    <h1 className="text-3xl font-bold text-center mb-6 text-green-400 drop-shadow hacker-font">
                        PhishAssure ü™ù
                    </h1>
                    <div className="bg-gray-800 p-8 rounded-lg shadow-lg">
                        <form onSubmit={handleSubmit}>
                            <div className="mb-4">
                                <label htmlFor="url" className="block text-green-300 text-sm font-bold mb-2 hacker-font">
                                    Website URL
                                </label>
                                <input
                                    type="text"
                                    id="url"
                                    name="url"
                                    value={url}
                                    onChange={(e) => setUrl(e.target.value)}
                                    className="w-full px-4 py-2 border border-green-700 bg-gray-900 text-green-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 hacker-font"
                                    placeholder="e.g., https://example.com"
                                />
                                {error && <p className="text-red-400 text-sm mt-2">{error}</p>}
                            </div>
                            <button
                                type="submit"
                                className={`w-full mt-6 py-3 rounded-lg text-green-100 font-bold transition duration-200 hacker-font ${
                                    loading || !url ? 'bg-gray-700 cursor-not-allowed' : 'bg-green-700 hover:bg-green-600'
                                }`}
                                disabled={loading || !url}
                            >
                                {loading ? 'Analyzing...' : 'Analyze Phishing Risk'}
                            </button>
                        </form>
                    </div>

                    {(urlPrediction || contentPrediction) && (
                        <div className="mt-6 p-6 bg-gray-800 rounded-lg">
                            <h2 className="text-xl font-semibold mb-2 text-green-400 hacker-font">Prediction Results</h2>
                            {urlPrediction && (
                                <div className="mb-4">
                                    <h3 className="text-lg font-medium text-green-300 hacker-font">LSTM Model (URL Features)</h3>
                                    <p className="text-base text-green-200">
                                        Predicted as{' '}
                                        <span
                                            className={
                                                urlPrediction.result === 'Phishing'
                                                    ? 'text-red-400 font-bold'
                                                    : 'text-green-400 font-bold'
                                            }
                                        >
                                            {urlPrediction.result}
                                        </span>{' '}
                                        with {urlPrediction.confidence}% confidence.
                                        <br />
                                        Model Accuracy: {urlPrediction.accuracy}
                                    </p>
                                </div>
                            )}
                            {contentPrediction && (
                                <div>
                                    <h3 className="text-lg font-medium text-green-300 hacker-font">RoBERTa Model (Content Features)</h3>
                                    <p className="text-base text-green-200">
                                        Predicted as{' '}
                                        <span
                                            className={
                                                contentPrediction.result === 'Phishing'
                                                    ? 'text-red-400 font-bold'
                                                    : 'text-green-400 font-bold'
                                            }
                                        >
                                            {contentPrediction.result}
                                        </span>{' '}
                                        with {contentPrediction.confidence}% confidence.
                                        <br />
                                        Model Accuracy: {contentPrediction.accuracy}, Recall: {contentPrediction.recall}
                                    </p>
                                </div>
                            )}
                        </div>
                    )}

                    {(Object.keys(urlFeatures).length > 0 || Object.keys(contentFeatures).length > 0) && (
                        <div className="mt-6 p-6 bg-gray-800 rounded-lg">
                            <h2 className="text-xl font-semibold mb-2 text-green-400 hacker-font">Extracted Features</h2>
                            <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                <div>
                                    <h3 className="text-lg font-medium mb-2 text-green-300 hacker-font">URL Features (LSTM)</h3>
                                    <div className="grid grid-cols-2 gap-2 text-sm text-green-200">
                                        {Object.entries(urlFeatures).map(([key, value]) => (
                                            <div key={key} className="flex justify-between">
                                                <span>{key}:</span>
                                                <span>{value}</span>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                                <div>
                                    <h3 className="text-lg font-medium mb-2 text-green-300 hacker-font">Content Features (RoBERTa)</h3>
                                    <div className="grid grid-cols-2 gap-2 text-sm text-green-200">
                                        {Object.entries(contentFeatures).map(([key, value]) => (
                                            <div key={key} className="flex justify-between">
                                                <span>{key}:</span>
                                                <span>{value}</span>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<PhishingDetector />, document.getElementById('root'));
    </script>
</body>
</html>